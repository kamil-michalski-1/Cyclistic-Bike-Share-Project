<h1>Data cleaning</h1>
Further procedures were conducted to confirm the integrity of data and better understand its structure and potential limitations. The aspects reviewed included:
<li>Check what rideable types are visible in the dataset and confirm that all trips had a meaningful rideable type indicated. Three rideable types were noted with no incorrect or unexpected values in the dataset.</li>

```sql
  SELECT rideable_type, COUNT(ride_id) AS trips_per_rideable_type
  FROM `trips_2022.trips_2022`
  GROUP BY rideable_type
```
|Row|rideable_type|trips_per_rideable_type|
|:-:|:-:|:-:|
|1|classic_bike|2601214|
|2|docked_bike|177474|
|3|electric_bike|2889029|

<li>Values of member vs. casual data were examined to check for incorrect or unexpected values. No irregularities were noted in the dataset.</li>

```sql
  SELECT member_casual, COUNT(ride_id) as trips_per_user_type
  FROM `trips_2022.trips_2022`
  GROUP BY member_casual
```

|Row|member_casual|trips_per_user_type|
|:-:|:-:|:-:|
|1|member|3345685|
|2|casual|2322032|

<li>The dataset was examined for correctness of trip start and end times. For this purpose maximum and minimum ride times were identified based on a calculation from start and end timestamps. The minimum ride time had a negative value, which pointed to potential issues in data integrity. Further procedures to understand the incidence of negative ride times and impact on the reliability of the dataset were conducted in next steps.</li>

```sql
  SELECT MAX(ended_at - started_at) AS max_ride_length, MIN(ended_at - started_at) AS min_ride_length
  FROM `trips_2022.trips_2022`
```

|Row|max_ride_length|min_ride_length|
|:-:|:-:|:-:|
|1|0-0 0 689:47:15|0-0 0 -172:33:21|

<li>The dataset was queried to identify and review all records with negative ride times - as per code below. This revealed that only 100 records had ride times with a negative value. No pattern was detected for entries with negative ride times, e.g. against days of the week, rideable types or user types (casual or member).</li>

```sql
  SELECT ride_id, rideable_type, started_at,ended_at, member_casual, (ended_at - started_at) AS ride_length,
  FORMAT_DATE('%A', started_at) AS day_of_week
  FROM `trips_2022.trips_2022`
  WHERE TIMESTAMP_DIFF(ended_at,started_at,second) < 0
```

```sql
  SELECT rideable_type, COUNT(ride_id) AS number_of_trips
  FROM `trips_2022.trips_2022`
  WHERE TIMESTAMP_DIFF(ended_at,started_at,second) < 0
  GROUP BY rideable_type
```

|Row|rideable_type|number_of_trips|
|:-:|:-:|:-:|
|1|classic_bike|28|
|2|electric_bike|72|


```sql
  SELECT member_casual, COUNT(ride_id) AS number_of_trips
  FROM `trips_2022.trips_2022`
  WHERE TIMESTAMP_DIFF(ended_at,started_at,second) < 0
  GROUP BY member_casual
```

|Row|member_casual|number_of_trips|
|:-:|:-:|:-:|
|1|casual|55|
|2|member|45|

```sql
  SELECT FORMAT_DATE('%A', started_at) AS day_of_week, COUNT(ride_id) AS number_of_trips
  FROM `trips_2022.trips_2022`
  WHERE TIMESTAMP_DIFF(ended_at,started_at,second) < 0
  GROUP BY day_of_week
  ORDER BY number_of_trips DESC
```

|Row|day_of_week|number_of_trips|
|:-:|:-:|:-:|
|1|Sunday|40|
|2|Tuesday|23|
|3|Saturday|12|
|4|Thursday|9|
|5|Monday|8|
|6|Friday|6|
|7|Wednesday|2|

<h1>Data transformation</h1>

<h1>Conclusion</h1>

